How are firewall rules prioritized and processed?